

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-17487464-6']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>10. File Input/Output &mdash; C Programming  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="C Programming  documentation" href="../"/>
        <link rel="next" title="11. Following Specification" href="../fs/"/>
        <link rel="prev" title="9. Strings" href="../strings/"/>
<link rel="stylesheet" href="../../css/math.css" type="text/css" />


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../" class="icon icon-home"> C Programming
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/">2. Basics of C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/">3. Console I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oae/">4. Operators and Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cf/">5. Control Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ap/">6. Arrays and Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../func/">7. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../su/">8. Structures and Unions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../strings/">9. Strings</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">10. File Input/Output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#text-and-binary-files">10.1. Text and Binary Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions-related-to-files">10.2. Functions Related to Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fopen-and-fclose-function">10.2.1. fopen and fclose Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fputc-and-fgetc-function">10.2.2. fputc and fgetc Function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#file-poisitoning-functions">10.3. File Poisitoning Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fgetpos-function">10.3.1. fgetpos Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fseek-function">10.3.2. fseek Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fsetpos-function">10.3.3. fsetpos Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ftell-function">10.3.4. ftell Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rewind-function">10.3.5. rewind Function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stream-buffering">10.4. Stream Buffering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fflush-function">10.4.1. fflush Function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#controlling-buffering">10.5. Controlling Buffering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#peeking-ahead-ungetc-function">10.6. Peeking Ahead ungetc Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#operation-on-files">10.7. Operation on Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fs/">11. Following Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env/">12. Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lang/">13. Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../macros/">14. Preprocessing Directives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../std/">15. The C Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assert/">16. Diagnostics <code class="docutils literal"><span class="pre">&lt;assert.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../complex/">17. Complex arithmetic <code class="docutils literal"><span class="pre">&lt;complex.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ctypes/">18. Character Handling <code class="docutils literal"><span class="pre">&lt;ctype.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../errno/">19. Errors <code class="docutils literal"><span class="pre">&lt;errno.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fenv/">20. Floating-point environment <code class="docutils literal"><span class="pre">&lt;fenv.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../float/">21. Characteristics of floating types <code class="docutils literal"><span class="pre">&lt;float.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../inttypes/">22. Format conversion of integer types <code class="docutils literal"><span class="pre">&lt;inttypes.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../iso646/">23. Alternative spellings <code class="docutils literal"><span class="pre">&lt;iso646.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../limits/">24. Sizes of integer types <code class="docutils literal"><span class="pre">&lt;limits.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../locale/">25. Localization &lt;locale.h&gt;</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/">26. Mathematics <code class="docutils literal"><span class="pre">&lt;math.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../setjmp/">27. Nonlocal jumps <code class="docutils literal"><span class="pre">&lt;setjmp.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../signal/">28. Signal handling <code class="docutils literal"><span class="pre">&lt;signal.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stdarg/">29. Variable arguments <code class="docutils literal"><span class="pre">&lt;stdarg.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stdbool/">30. Boolean type and values <code class="docutils literal"><span class="pre">&lt;stdbool.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stddef/">31. Common definitions <code class="docutils literal"><span class="pre">&lt;stddef.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stdint/">32. Integer types <code class="docutils literal"><span class="pre">&lt;stdint.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stdio/">33. Input/output <code class="docutils literal"><span class="pre">&lt;stdio.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stdlib/">34. General utilities <code class="docutils literal"><span class="pre">&lt;stdlib.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../string/">35. String handling <code class="docutils literal"><span class="pre">&lt;string.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tgmath/">36. Type-generic math <code class="docutils literal"><span class="pre">&lt;tgmath.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../time/">37. Date and time <code class="docutils literal"><span class="pre">&lt;time.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../wchar/">38. Extended multibyte and wide character utilities <code class="docutils literal"><span class="pre">&lt;wchar.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../wtype/">39. Wide character classification and mapping utilities <code class="docutils literal"><span class="pre">&lt;wctype.h&gt;</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../problems/">40. Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license/">41. License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../">C Programming</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../">Docs</a> &raquo;</li>
      
    <li>10. File Input/Output</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/fileio.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="file-input-output">
<h1>10. File Input/Output<a class="headerlink" href="#file-input-output" title="Permalink to this headline">¶</a></h1>
<p>In this chapter we will study how to perform IO on a file i.e. how we read data
from file or how we write data to file. Any significant program operate on
files. For exmaple, reading and parsing a configuration file is a very common
operation. Understanding the concepts related to file IO is very critical to
write large programs. First question is that what is a
file. Well on GNU/Linux which I am going to focus on treats everything as a
file. A file is a resource which stores information. It can be in memory
i.e. RAM or hard disk. A file can be of several types. If you perform <code class="docutils literal"><span class="pre">ls</span> <span class="pre">-l</span></code>
in a directory then the first character of line for each file tells you about
type of file. Given below is a table for this:</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">First character</th>
<th class="head">Type of file</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&#8220;-&#8220;</td>
<td>ordinary file</td>
</tr>
<tr class="row-odd"><td>d</td>
<td>directory</td>
</tr>
<tr class="row-even"><td>l</td>
<td>symbolic link</td>
</tr>
<tr class="row-odd"><td>p</td>
<td>named pipe</td>
</tr>
<tr class="row-even"><td>s</td>
<td>socket</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>character device</td>
</tr>
<tr class="row-even"><td>b</td>
<td>block device</td>
</tr>
</tbody>
</table>
<p>We are going to be concerned with first type only because to operate on other
types of devices you need to use library or system calls provided by
GNU/Linux. For example, to read a sirectory you have <code class="docutils literal"><span class="pre">readdir()</span></code> system call,
to open a socket you have <code class="docutils literal"><span class="pre">socket()</span></code> system call and so on. These functions
are out of scope of this book.</p>
<div class="section" id="text-and-binary-files">
<h2>10.1. Text and Binary Files<a class="headerlink" href="#text-and-binary-files" title="Permalink to this headline">¶</a></h2>
<p>POSIX specification defined a text file that contains characters zero or more
lines. The beauty of a text file is that it has no metadata therefore it can be
of zero bytes in length. Usually a text file will contain either all ASCII or
UTF-8 characters. However, text files can contain other characters as well. For
our discussion we will focus on ASCII text files. On GNU/Linux or other Unix
systems lines are separated by <code class="docutils literal"><span class="pre">\n</span></code> while on Windows they are separated by
<code class="docutils literal"><span class="pre">\r\n</span></code>. This is a very important difference if you are processing file on the
basis of individual characters.</p>
<p>Binary files are those files which are not text files. Some binary files
contain headers, blocks of metadata used by a computer program to interpret the
data in the file. The header often contains a signature or magic number which
can identify the format. If a binary file does not contain headers then it is
called <em>flat binary file</em>.</p>
</div>
<div class="section" id="functions-related-to-files">
<h2>10.2. Functions Related to Files<a class="headerlink" href="#functions-related-to-files" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fopen-and-fclose-function">
<h3>10.2.1. fopen and fclose Function<a class="headerlink" href="#fopen-and-fclose-function" title="Permalink to this headline">¶</a></h3>
<p>Before you can do anything with a file you need to open it which is done by
using <code class="docutils literal"><span class="pre">fopen</span></code> function. <code class="docutils literal"><span class="pre">fopen</span></code> returns a <code class="docutils literal"><span class="pre">FILE</span> <span class="pre">*</span></code> as a return value. For
historical reasons, he type of the C data
structure that represents a stream is called <code class="docutils literal"><span class="pre">FILE</span></code> rather than
&#8220;stream&#8221;. Since C library functions deal with objects of type <code class="docutils literal"><span class="pre">FILE</span> <span class="pre">*</span></code>,
sometimes the term file pointer is also used to mean &#8220;stream&#8221;. This leads to
unfortunate confusion over terminology in many books on C.The <code class="docutils literal"><span class="pre">FILE</span></code> type is
declared in the header <code class="docutils literal"><span class="pre">stdio.h</span></code>.</p>
<p>When you open a file internally a file descriptor is used which is associated
with the <code class="docutils literal"><span class="pre">FILE</span></code> object. Now the number of files which can be open at the same
time is limited. The number of files which can be opened at the same time is
governed by <code class="docutils literal"><span class="pre">ulimit</span></code> command. There is a macro <code class="docutils literal"><span class="pre">FOPEN_MAX</span></code> which is the
minimum number of files that can be opened and is guaranteed by
implementation. Therefore, it is very important that you close a file once you
have no further use of its contents. To close a file you use <code class="docutils literal"><span class="pre">fclose</span></code>
function. Matching an <code class="docutils literal"><span class="pre">fopen</span></code> with <code class="docutils literal"><span class="pre">fclose</span></code> is same as matching a call to
<code class="docutils literal"><span class="pre">malloc,</span> <span class="pre">calloc,</span> <span class="pre">realloc</span></code> with <code class="docutils literal"><span class="pre">free</span></code>.</p>
<p><code class="docutils literal"><span class="pre">fopen</span></code> function is describe in great detail at section <a class="reference internal" href="../stdio/#fopen"><span>The fopen function</span></a> and
<code class="docutils literal"><span class="pre">fclose</span></code> is descibed at section <a class="reference internal" href="../stdio/#fclose"><span>The fclose function</span></a>. You should read the sections
to know more about these functions. Let us look at the signatures first:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="kt">FILE</span> <span class="o">*</span><span class="nf">fopen</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="kr">restrict</span> <span class="n">filename</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="kr">restrict</span> <span class="n">mode</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">fclose</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">mode</span></code> is what is described in section mentioned above. <code class="docutils literal"><span class="pre">filename</span></code> is path
on your filesystem. It can be absolute or relative. However, you must have
correct permission i.e. read and write permissions. These permission are
govered by your operating system. For example, you will almost always have
permission inside your home directory. Let us try to create a file in this
directory. Since we are going to create we will use <code class="docutils literal"><span class="pre">w</span></code> mode. For example:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;string.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">fp</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

  <span class="k">if</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;temp.txt&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Successfully opened file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>

  <span class="p">}</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>if you run this program then you should see:</p>
<div class="highlight-text"><div class="highlight"><pre>Successfully opened file.
</pre></div>
</div>
<p>and if you check your directory in which program is then you will see an empty
file <code class="docutils literal"><span class="pre">temp.txt</span></code> created. It is important to check for errors when you call
<code class="docutils literal"><span class="pre">fclose</span></code> to close an output stream, because real, everyday errors can be
detected at this time. For example, when <code class="docutils literal"><span class="pre">fclose</span></code> writes the remaining
buffered output, it might get an error because the disk is full. Even if you
know the buffer is empty, errors can still occur when closing a file if you are
using NFS.</p>
</div>
<div class="section" id="fputc-and-fgetc-function">
<span id="index-0"></span><h3>10.2.2. fputc and fgetc Function<a class="headerlink" href="#fputc-and-fgetc-function" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">fputc</span></code> and <code class="docutils literal"><span class="pre">fgetc</span></code> are described at sections <a class="reference internal" href="../stdio/#fputc"><span>The fputc function</span></a> and <a class="reference internal" href="../stdio/#fgetc"><span>The fgetc function</span></a>
respectively. Let us see an example:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;string.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">fp</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

  <span class="k">if</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;temp.txt&quot;</span><span class="p">,</span> <span class="s">&quot;r+&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">fputc</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span> <span class="o">==</span> <span class="n">EOF</span><span class="p">)</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Could not write to file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>

  <span class="k">if</span><span class="p">(</span><span class="n">fp</span><span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;temp.txt&quot;</span><span class="p">,</span> <span class="s">&quot;r+&quot;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">((</span><span class="n">n</span> <span class="o">=</span> <span class="n">fgetc</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span> <span class="o">==</span> <span class="n">EOF</span><span class="p">)</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Could not read from file.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
    <span class="k">else</span>
      <span class="n">putchar</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">n</span> <span class="o">=</span> <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>and the output is <code class="docutils literal"><span class="pre">a</span></code>. Note that we have to close file stream and then open
again because once you write <code class="docutils literal"><span class="pre">a</span></code> to file then file pointer advances to next
location. Therefore if we try to read without closing and opening again then
<code class="docutils literal"><span class="pre">fgetc</span></code> will return <code class="docutils literal"><span class="pre">EOF</span></code>.</p>
<p>Now this pogram could have been written without closing file and opening again
if we could reposition file pointer to beginning. C gives us that facility to
reposition the file pointer. We have several functions to do that. <code class="docutils literal"><span class="pre">fgetpos,</span>
<span class="pre">fseek,</span> <span class="pre">fgetpos,</span> <span class="pre">ftell</span></code> and <code class="docutils literal"><span class="pre">rewind</span></code> function. These functions are described
in sections <a class="reference internal" href="../stdio/#fgetpos"><span>The fgetpos function</span></a>, <a class="reference internal" href="../stdio/#fseek"><span>The fseek function</span></a>, <a class="reference internal" href="../stdio/#fgetpos"><span>The fgetpos function</span></a>, <a class="reference internal" href="../stdio/#ftell"><span>The ftell function</span></a> and
<a class="reference internal" href="../stdio/#rewind"><span>The rewind function</span></a> respectively. All these functions are defined in header file
<code class="docutils literal"><span class="pre">stdio.h</span></code>. If you read these sections then you will get a very
good idea about what these functions do. Asuuming you have read and encountered
three macros <code class="docutils literal"><span class="pre">SEEK_SET,</span> <span class="pre">SEEK_CUR</span></code> and <code class="docutils literal"><span class="pre">SEEK_END</span></code>. These give position of
beginning of file, current position of file pointer and end of file
respectively. Let us see examples of these functions one by one.</p>
</div>
</div>
<div class="section" id="file-poisitoning-functions">
<h2>10.3. File Poisitoning Functions<a class="headerlink" href="#file-poisitoning-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fgetpos-function">
<span id="index-1"></span><h3>10.3.1. fgetpos Function<a class="headerlink" href="#fgetpos-function" title="Permalink to this headline">¶</a></h3>
<p>I am giving the signature here as well.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">fgetpos</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span> <span class="kr">restrict</span> <span class="n">stream</span><span class="p">,</span> <span class="kt">fpos_t</span> <span class="o">*</span> <span class="kr">restrict</span> <span class="n">pos</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">pos</span></code> is output parameter which is set by <code class="docutils literal"><span class="pre">fgetpos</span></code> which can be used by
<code class="docutils literal"><span class="pre">fsetpos</span></code> function.</p>
</div>
<div class="section" id="fseek-function">
<span id="index-2"></span><h3>10.3.2. fseek Function<a class="headerlink" href="#fseek-function" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">fseek</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">int</span> <span class="n">whence</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">whence</span></code> can be an integer or one of the three file positioning
macros. <code class="docutils literal"><span class="pre">offset</span></code> is offset from <code class="docutils literal"><span class="pre">whence</span></code>. So <code class="docutils literal"><span class="pre">whence</span></code> and <code class="docutils literal"><span class="pre">offset</span></code> will
be added and file pointer will be set to that position.</p>
</div>
<div class="section" id="fsetpos-function">
<span id="index-3"></span><h3>10.3.3. fsetpos Function<a class="headerlink" href="#fsetpos-function" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">fsetpos</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">,</span> <span class="k">const</span> <span class="kt">fpos_t</span> <span class="o">*</span><span class="n">pos</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">fsetpos</span></code> sets the file pointer to the position which you can get from
<code class="docutils literal"><span class="pre">fgetpos</span></code>.</p>
</div>
<div class="section" id="ftell-function">
<span id="index-4"></span><h3>10.3.4. ftell Function<a class="headerlink" href="#ftell-function" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">long</span> <span class="kt">int</span> <span class="nf">ftell</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">ftell</span></code> gives current value of file position indicator.</p>
</div>
<div class="section" id="rewind-function">
<span id="index-5"></span><h3>10.3.5. rewind Function<a class="headerlink" href="#rewind-function" title="Permalink to this headline">¶</a></h3>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">rewind</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">rewind</span></code> function sets the file position indicator for the <code class="docutils literal"><span class="pre">stream</span></code>
pointed to by <code class="docutils literal"><span class="pre">stream</span></code> to the beginning of the file. It is equivalent to</p>
<div class="highlight-c"><div class="highlight"><pre><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">fseek</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="mi">0L</span><span class="p">,</span> <span class="n">SEEK_SET</span><span class="p">)</span>
</pre></div>
</div>
<p>except that the error indicator for the <code class="docutils literal"><span class="pre">stream</span></code> is also cleared.</p>
<p>Now let us try to use these functions altogether.</p>
<p>Edit the <code class="docutils literal"><span class="pre">temp.txt</span></code> file created above or create a new file with this name
and put <code class="docutils literal"><span class="pre">Hello</span> <span class="pre">world!</span></code> in it.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">FILE</span> <span class="o">*</span><span class="n">fp</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

  <span class="k">if</span><span class="p">((</span><span class="n">fp</span><span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;temp.txt&quot;</span><span class="p">,</span> <span class="s">&quot;r+&quot;</span><span class="p">)))</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">fpos_t</span> <span class="n">pos</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">fgetpos</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">))</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Could not get file position.&quot;</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ftell</span><span class="p">(</span><span class="n">fp</span><span class="p">));</span>

    <span class="k">while</span><span class="p">((</span><span class="n">c</span><span class="o">=</span><span class="n">fgetc</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
      <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ftell</span><span class="p">(</span><span class="n">fp</span><span class="p">));</span>

    <span class="k">if</span><span class="p">(</span><span class="n">fsetpos</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pos</span><span class="p">))</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Could not set file position.&quot;</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ftell</span><span class="p">(</span><span class="n">fp</span><span class="p">));</span>

    <span class="k">while</span><span class="p">((</span><span class="n">c</span><span class="o">=</span><span class="n">fgetc</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
      <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ftell</span><span class="p">(</span><span class="n">fp</span><span class="p">));</span>
    <span class="n">fseek</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SEEK_SET</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ftell</span><span class="p">(</span><span class="n">fp</span><span class="p">));</span>

    <span class="k">while</span><span class="p">((</span><span class="n">c</span><span class="o">=</span><span class="n">fgetc</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span> <span class="o">!=</span> <span class="n">EOF</span><span class="p">)</span>
      <span class="n">putchar</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ftell</span><span class="p">(</span><span class="n">fp</span><span class="p">));</span>
    <span class="n">rewind</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ftell</span><span class="p">(</span><span class="n">fp</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>

  <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">&quot;File could not be closed.&quot;</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The program is very simple and you can guess the output which is given below:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="mi">0</span>
<span class="n">Hello</span> <span class="n">world</span><span class="o">!</span>
<span class="mi">13</span>
<span class="mi">0</span>
<span class="n">Hello</span> <span class="n">world</span><span class="o">!</span>
<span class="mi">13</span>
<span class="mi">0</span>
<span class="n">Hello</span> <span class="n">world</span><span class="o">!</span>
<span class="mi">13</span>
<span class="mi">0</span>
</pre></div>
</div>
<p>While <code class="docutils literal"><span class="pre">fgetc</span></code> and <code class="docutils literal"><span class="pre">fputc</span></code> are nice but they are limited to once character
each. There are other more efficient functions like <code class="docutils literal"><span class="pre">fprintf,</span> <span class="pre">fscanf,</span> <span class="pre">fputs,</span>
<span class="pre">fgets,</span> <span class="pre">fwrite</span></code> and <code class="docutils literal"><span class="pre">fread</span></code> all described in <a class="reference internal" href="../stdio/#stdio"><span>Input/output &lt;stdio.h&gt;</span></a>. The usage is
simple and can be figured from their signature. If you need to read or write
multiple characters at the same time consider using one of those for efficiency
depending on your requirement.</p>
<p>Now there are three special streams <code class="docutils literal"><span class="pre">stdout,</span> <span class="pre">stdin</span></code> and <code class="docutils literal"><span class="pre">stderr</span></code> which are
for output, input and error respectively. They can be treated as <code class="docutils literal"><span class="pre">FILE</span></code>
streams. For example, you can close <code class="docutils literal"><span class="pre">stdout</span></code> stream and then you can redirect
it to a file. For example:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">fclose</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
  <span class="n">stdout</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;temp.txt&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span>
  <span class="n">fprintf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">&quot;Surprise!!!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
  <span class="n">fclose</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you open file <code class="docutils literal"><span class="pre">temp.txt</span></code> after running this program then it will contain
the text which we are printing rather than appearing on console because we have
attached <code class="docutils literal"><span class="pre">stdout</span></code> to <code class="docutils literal"><span class="pre">temp.txt</span></code>. Note that if you use <code class="docutils literal"><span class="pre">printf</span></code> then the
default behavior of <code class="docutils literal"><span class="pre">stdout</span></code> will kick in which is line buffering and also
since you are writing to a file it will be fully buffered so even a call to set
buffering to <code class="docutils literal"><span class="pre">NULL</span></code> will not help. You can set buffering to <code class="docutils literal"><span class="pre">NULL</span></code> by
calling <code class="docutils literal"><span class="pre">setbuf(stdout,</span> <span class="pre">NULL);</span></code> and then flushing the stdout stream using
<code class="docutils literal"><span class="pre">fflush(stdout);</span></code> everytime you want to clear the stream. But since file is
fully buffered these calls will still not print to file if you use
<code class="docutils literal"><span class="pre">printf</span></code>. <code class="docutils literal"><span class="pre">stderr</span></code> is not buffered. We cover buffering next.</p>
</div>
</div>
<div class="section" id="stream-buffering">
<h2>10.4. Stream Buffering<a class="headerlink" href="#stream-buffering" title="Permalink to this headline">¶</a></h2>
<p>When we output or input something in C it is not immediate but is rather
delayed. Typically it is stored in a buffer whose size is controlled by a macro
<code class="docutils literal"><span class="pre">BUFSIZ</span></code>. The reason for this is it is inefficient to read or write content
to streams as soon as they come character by character. Therefore it is very
important to understand buffering because you will be always giving some output
and most of the time taking some input. If you do not understand buffering then
your interactive programs may not behave as you intend them to. There are three
separate kinds of buffering.</p>
<ul class="simple">
<li>No buffering. Content is transferred as soon as it comes.</li>
<li>Line buffering. Content is transferred as soon as new line occurs.</li>
<li>Full buffering. Content is transferred as soon as <code class="docutils literal"><span class="pre">BUFSIZ</span></code> is achieved by
buffer.</li>
</ul>
<p>Whenever you open a file stream it is fully buffered except when the stream is
connected to an interactive device such as a terminal. A stream like <code class="docutils literal"><span class="pre">stdout</span></code>
which is connected to terminal is line buffered. Usually the buffering settings
are optimized for convenience and performance but there will be times when you
would want to override those. There are times when we want output to appear
immediattely for <code class="docutils literal"><span class="pre">stdout</span></code>. The simplest way is to use <code class="docutils literal"><span class="pre">\n</span></code> because
<code class="docutils literal"><span class="pre">stdout</span></code> is line buffered. But there is another choice and you can use
<code class="docutils literal"><span class="pre">fflush</span></code> to flush the buffer.</p>
<p>Flushing output on buffered streams means transmitting all content in buffer to
the file. There are many circumstances when this happens automatically:</p>
<ul class="simple">
<li>When you try to do output and the output buffer is full.</li>
<li>When the stream is closed.</li>
<li>When the program terminates by calling <code class="docutils literal"><span class="pre">exit</span></code>.</li>
<li>When a newline is written, if the stream is line buffered.</li>
<li>Whenever an input operation on any stream actually reads data from its file.</li>
</ul>
<div class="section" id="fflush-function">
<h3>10.4.1. fflush Function<a class="headerlink" href="#fflush-function" title="Permalink to this headline">¶</a></h3>
<p>It is described at <a class="reference internal" href="../stdio/#fflush"><span>The fflush function</span></a>.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">fflush</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">);</span>
</pre></div>
</div>
<p>Typically you can use it like <code class="docutils literal"><span class="pre">fflush(stdout);</span></code>. The <code class="docutils literal"><span class="pre">fflush</span></code> function can
be used to flush all streams currently opened. While this is useful in some
situations it does often more than necessary since it might be done in
situations when terminal input is required and the program wants to be sure
that all output is visible on the terminal. But this means that only line
buffered streams have to be flushed.</p>
<p>However, if you want to control buffering to your streams for your special
purposed then you have two functions at your disposal which we will study next.</p>
</div>
</div>
<div class="section" id="controlling-buffering">
<h2>10.5. Controlling Buffering<a class="headerlink" href="#controlling-buffering" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">setbuf</span></code> and <code class="docutils literal"><span class="pre">setvbuf</span></code> are two functions which are used to control
buffering and are described at <a class="reference internal" href="../stdio/#id22"><span>The setbuf function</span></a> and <a class="reference internal" href="../stdio/#id23"><span>The setvbuf function</span></a> respectively.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">setbuf</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span> <span class="kr">restrict</span> <span class="n">stream</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="kr">restrict</span> <span class="n">buf</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">setvbuf</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span> <span class="kr">restrict</span> <span class="n">stream</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="kr">restrict</span> <span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">setvbuf</span></code> function is used to specify that the stream stream should have the
buffering mode mode, which can be either <code class="docutils literal"><span class="pre">_IOFBF</span></code> (for full buffering),
<code class="docutils literal"><span class="pre">_IOLBF</span></code> (for line buffering), or <code class="docutils literal"><span class="pre">_IONBF</span></code> (for unbuffered input/output).</p>
<p>If you specify a null pointer as the <code class="docutils literal"><span class="pre">buf</span></code> argument, then <code class="docutils literal"><span class="pre">setvbuf</span></code>
allocates a buffer itself using <code class="docutils literal"><span class="pre">malloc</span></code>. This buffer will be freed when you
close the stream.</p>
<p>Otherwise, <code class="docutils literal"><span class="pre">buf</span></code> should be a character array that can hold at least <code class="docutils literal"><span class="pre">size</span></code>
characters. You should not free the space for this array as long as the
<code class="docutils literal"><span class="pre">stream</span></code> remains open and this array remains its buffer. You should usually
either allocate it statically, or <code class="docutils literal"><span class="pre">malloc</span></code> the buffer. Using an automatic
array is not a good idea unless you close the file before exiting the block
that declares the array.</p>
<p>While the array remains a stream buffer, the stream I/O functions will use the
buffer for their internal purposes. You shouldn&#8217;t try to access the values in
the array directly while the stream is using it for buffering.</p>
<p>If <code class="docutils literal"><span class="pre">buf</span></code> is a null pointer, the effect of this function is equivalent to
calling <code class="docutils literal"><span class="pre">setvbuf</span></code> with a mode argument of <code class="docutils literal"><span class="pre">_IONBF</span></code>. Otherwise, it is
equivalent to calling <code class="docutils literal"><span class="pre">setvbuf</span></code> with <code class="docutils literal"><span class="pre">buf</span></code>, and a mode of <code class="docutils literal"><span class="pre">_IOFBF</span></code> and a
<code class="docutils literal"><span class="pre">size</span></code> argument of <code class="docutils literal"><span class="pre">BUFSIZ</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">setbuf</span></code> function is provided for compatibility with old code; use
<code class="docutils literal"><span class="pre">setvbuf</span></code> in all new programs.</p>
</div>
<div class="section" id="peeking-ahead-ungetc-function">
<h2>10.6. Peeking Ahead ungetc Function<a class="headerlink" href="#peeking-ahead-ungetc-function" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">ungetc</span></code> function is used to put back a character which has been read from an
input stream to input stream back. Consider the following program:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">int</span> <span class="nf">ungetc</span><span class="p">(</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span> <span class="kt">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">);</span>
</pre></div>
</div>
<p>If <code class="docutils literal"><span class="pre">c</span></code> is <code class="docutils literal"><span class="pre">EOF</span></code>, <code class="docutils literal"><span class="pre">ungetc</span></code> does nothing and just returns <code class="docutils literal"><span class="pre">EOF</span></code>. This
lets you call <code class="docutils literal"><span class="pre">ungetc</span></code> with the return value of <code class="docutils literal"><span class="pre">getc</span></code> without needing to
check for an error from <code class="docutils literal"><span class="pre">getc</span></code>.</p>
<p>The character that you push back doesn&#8217;t have to be the same as the last
character that was actually read from the <code class="docutils literal"><span class="pre">stream</span></code>. In fact, it isn&#8217;t
necessary to actually read any characters from the <code class="docutils literal"><span class="pre">stream</span></code> before unreading
them with <code class="docutils literal"><span class="pre">ungetc</span></code>! But that is a strange way to write a program; usually
<code class="docutils literal"><span class="pre">ungetc</span></code> is used only to unread a character that was just read from the same
stream. The GNU C Library supports this even on files opened in binary mode,
but other systems might not.</p>
<p>The GNU C Library only supports one character of pushback-in other words, it
does not work to call <code class="docutils literal"><span class="pre">ungetc</span></code> twice without doing input in between.</p>
<p>Pushing back characters doesn&#8217;t alter the file; only the internal buffering for the stream is affected. If a file positioning function (such as <code class="docutils literal"><span class="pre">fseek</span></code> or <code class="docutils literal"><span class="pre">rewind</span></code>) is called, any pending pushed-back characters are discarded.</p>
<p>Unreading a character on a stream that is at end of file clears the end-of-file
indicator for the stream, because it makes the character of input
available. After you read that character, trying to read again will encounter
end of file.</p>
<p>A simple example is give below:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">putchar</span><span class="p">(</span><span class="n">getchar</span><span class="p">());</span>
  <span class="n">ungetc</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
  <span class="n">putchar</span><span class="p">(</span><span class="n">getchar</span><span class="p">());</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="operation-on-files">
<h2>10.7. Operation on Files<a class="headerlink" href="#operation-on-files" title="Permalink to this headline">¶</a></h2>
<p>We have seen how to create files and do IO on that. For removal and renaming
there are two functions <code class="docutils literal"><span class="pre">remove</span></code> and <code class="docutils literal"><span class="pre">rename</span></code> which do what their name
suggests. Then there are two functions which generate a temporary file and a
temporary unique name. They are <code class="docutils literal"><span class="pre">tmpfile</span></code> and <code class="docutils literal"><span class="pre">tmpnam</span></code> respectively. These
funcitons signatures and details can be found at <a class="reference internal" href="../stdio/#remove"><span>The remove function</span></a>, <a class="reference internal" href="../stdio/#rename"><span>The rename function</span></a>,
<a class="reference internal" href="../stdio/#tmpfile"><span>The tmpfile function</span></a> and <a class="reference internal" href="../stdio/#tmpnam"><span>The tmpnam function</span></a> sections respectively. These are very simple
and trivial to use functions.</p>
<p>With this we come to an end of File IO. Functions for which examples are not
given will be covered in <a class="reference internal" href="../stdio/#stdio"><span>Input/output &lt;stdio.h&gt;</span></a> chapter.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../fs/" class="btn btn-neutral float-right" title="11. Following Specification" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../strings/" class="btn btn-neutral" title="9. Strings" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012-2015, Shiv S. Dayal.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>