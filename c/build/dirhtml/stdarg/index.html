<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>27. Variable arguments &lt;stdarg.h&gt; &mdash; C99  documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="C99  documentation" href="../" />
    <link rel="next" title="28. Boolean type and values &lt;stdbool.h&gt;" href="../stdbool/" />
    <link rel="prev" title="26. Signal handling &lt;signal.h&gt;" href="../signal/" />
<script src="../_static/analytics.js" type="text/javascript"></script>
<link rel="stylesheet" href="../../../css/math.css" type="text/css" />

  </head>
  <body>




  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">Home</a>
        <a class="navbar-brand" href="../">
          C99</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics/">2. Basics of C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/">3. Console I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oae/">4. Operators and Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cf/">5. Control Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ap/">6. Arrays and Pointers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../func/">7. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../su/">8. Structures and Unions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fs/">9. Following Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env/">10. Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lang/">11. Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../macros/">12. Preprocessing Directives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../std/">13. The C Standard Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../assert/">14. Diagnostics <tt class="docutils literal"><span class="pre">&lt;assert.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../complex/">15. Complex arithmetic <tt class="docutils literal"><span class="pre">&lt;complex.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../ctypes/">16. Character Handling <tt class="docutils literal"><span class="pre">&lt;ctype.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../errno/">17. Errors <tt class="docutils literal"><span class="pre">&lt;errno.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../fenv/">18. Floating-point environment <tt class="docutils literal"><span class="pre">&lt;fenv.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../float/">19. Characteristics of floating types <tt class="docutils literal"><span class="pre">&lt;float.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../inttypes/">20. Format conversion of integer types <tt class="docutils literal"><span class="pre">&lt;inttypes.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../iso646/">21. Alternative spellings <tt class="docutils literal"><span class="pre">&lt;iso646.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../limits/">22. Sizes of integer types <tt class="docutils literal"><span class="pre">&lt;limits.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../locale/">23. Localization &lt;locale.h&gt;</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/">24. Mathematics <tt class="docutils literal"><span class="pre">&lt;math.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../setjmp/">25. Nonlocal jumps <tt class="docutils literal"><span class="pre">&lt;setjmp.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../signal/">26. Signal handling <tt class="docutils literal"><span class="pre">&lt;signal.h&gt;</span></tt></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">27. Variable arguments <tt class="docutils literal"><span class="pre">&lt;stdarg.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stdbool/">28. Boolean type and values <tt class="docutils literal"><span class="pre">&lt;stdbool.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stddef/">29. Common definitions <tt class="docutils literal"><span class="pre">&lt;stddef.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stdint/">30. Integer types <tt class="docutils literal"><span class="pre">&lt;stdint.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stdio/">31. Input/output <tt class="docutils literal"><span class="pre">&lt;stdio.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../stdlib/">32. General utilities <tt class="docutils literal"><span class="pre">&lt;stdlib.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../string/">33. String handling <tt class="docutils literal"><span class="pre">&lt;string.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tgmath/">34. Type-generic math <tt class="docutils literal"><span class="pre">&lt;tgmath.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../time/">35. Date and time <tt class="docutils literal"><span class="pre">&lt;time.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../wchar/">36. Extended multibyte and wide character utilities <tt class="docutils literal"><span class="pre">&lt;wchar.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../wtype/">37. Wide character classification and mapping utilities <tt class="docutils literal"><span class="pre">&lt;wctype.h&gt;</span></tt></a></li>
<li class="toctree-l1"><a class="reference internal" href="../problems/">38. Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license/">39. License</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">27. Variable arguments <tt class="docutils literal"><span class="pre">&lt;stdarg.h&gt;</span></tt></a><ul>
<li><a class="reference internal" href="#variable-argument-list-access-macros">27.1. Variable argument list access macros</a><ul>
<li><a class="reference internal" href="#the-va-arg-macro">27.1.1. The <tt class="docutils literal"><span class="pre">va_arg</span></tt> macro</a></li>
<li><a class="reference internal" href="#the-va-copy-macro">27.1.2. The <tt class="docutils literal"><span class="pre">va_copy</span></tt> macro</a></li>
<li><a class="reference internal" href="#the-va-end-macro">27.1.3. The <tt class="docutils literal"><span class="pre">va_end</span></tt> macro</a></li>
<li><a class="reference internal" href="#the-va-start-macro">27.1.4. The <tt class="docutils literal"><span class="pre">va_start</span></tt> macro</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../signal/" title="Previous Chapter: 26. Signal handling <signal.h>"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; 26. Signal handl...</span>
    </a>
  </li>
  <li>
    <a href="../stdbool/" title="Next Chapter: 28. Boolean type and values <stdbool.h>"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">28. Boolean type... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/stdarg.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search/" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="variable-arguments-stdarg-h">
<span id="stdarg"></span><span id="index-0"></span><h1>27. Variable arguments <tt class="docutils literal"><span class="pre">&lt;stdarg.h&gt;</span></tt><a class="headerlink" href="#variable-arguments-stdarg-h" title="Permalink to this headline">¶</a></h1>
<p>The header <tt class="docutils literal"><span class="pre">&lt;stdarg.h&gt;</span></tt> declares a type and defines four macros, for advancing
through a list of arguments whose number and types are not known to the called function
when it is translated.</p>
<p id="index-1">A function may be called with a variable number of arguments of varying types. As
described in <a class="reference internal" href="../lang/#id320"><em>Function definitions</em></a>, its parameter list contains one or more parameters. The rightmost
parameter plays a special role in the access mechanism, and will be designated <tt class="docutils literal"><span class="pre">parmN</span></tt> in
this description.</p>
<p>The type declared is</p>
<blockquote>
<div><div class="line-block">
<div class="line"><tt class="docutils literal"><span class="pre">va_list</span></tt></div>
</div>
</div></blockquote>
<p>which is an object type suitable for holding information needed by the macros
<tt class="docutils literal"><span class="pre">va_start,</span> <span class="pre">va_arg,</span> <span class="pre">va_end</span></tt> and <tt class="docutils literal"><span class="pre">va_copy</span></tt>. If access to the varying arguments is
desired, the called function shall declare an object (generally referred to as ap in this
subclause) having type <tt class="docutils literal"><span class="pre">va_list</span></tt>. The object <tt class="docutils literal"><span class="pre">ap</span></tt> may be passed as an argument to
another function; if that function invokes the <tt class="docutils literal"><span class="pre">va_arg</span></tt> macro with parameter ap, the
value of ap in the calling function is indeterminate and shall be passed to the <tt class="docutils literal"><span class="pre">va_end</span></tt>
macro prior to any further reference to ap. <a class="footnote-reference" href="#id2" id="id1">[1]</a></p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>It is permitted to create a pointer to a <tt class="docutils literal"><span class="pre">va_list</span></tt> and pass that pointer to another function, in which
case the original function may make further use of the original list after the other function returns.</td></tr>
</tbody>
</table>
<div class="section" id="variable-argument-list-access-macros">
<span id="index-2"></span><h2>27.1. Variable argument list access macros<a class="headerlink" href="#variable-argument-list-access-macros" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">va_start</span></tt> and <tt class="docutils literal"><span class="pre">va_arg</span></tt> macros described in this subclause shall be implemented
as macros, not functions. It is unspecified whether <tt class="docutils literal"><span class="pre">va_copy</span></tt> and <tt class="docutils literal"><span class="pre">va_end</span></tt> are macros or
identifiers declared with external linkage. If a macro definition is suppressed in order to
access an actual function, or a program defines an external identifier with the same name,
the behavior is undefined. Each invocation of the <tt class="docutils literal"><span class="pre">va_start</span></tt> and <tt class="docutils literal"><span class="pre">va_copy</span></tt> macros
shall be matched by a corresponding invocation of the va_end macro in the same
function.</p>
<div class="section" id="the-va-arg-macro">
<h3>27.1.1. The <tt class="docutils literal"><span class="pre">va_arg</span></tt> macro<a class="headerlink" href="#the-va-arg-macro" title="Permalink to this headline">¶</a></h3>
<p><strong>Synopsis</strong></p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdarg.h&gt;</span>
<span class="n">type</span> <span class="nf">va_arg</span><span class="p">(</span><span class="kt">va_list</span> <span class="n">ap</span><span class="p">,</span> <span class="n">type</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Description</strong></p>
<p>The <tt class="docutils literal"><span class="pre">va_arg</span></tt> macro expands to an expression that has the specified type and the value of
the next argument in the call. The parameter ap shall have been initialized by the
<tt class="docutils literal"><span class="pre">va_start</span></tt> or <tt class="docutils literal"><span class="pre">va_copy</span></tt> macro (without an intervening invocation of the <tt class="docutils literal"><span class="pre">va_end</span></tt>
macro for the same <tt class="docutils literal"><span class="pre">ap</span></tt>). Each invocation of the <tt class="docutils literal"><span class="pre">va_arg</span></tt> macro modifies <tt class="docutils literal"><span class="pre">ap</span></tt> so that the
values of successive arguments are returned in turn. The parameter <em>type</em> shall be a type
name specified such that the type of a pointer to an object that has the specified type can
be obtained simply by postfixing a <tt class="docutils literal"><span class="pre">*</span></tt> to <em>type</em>. If there is no actual next argument, or if
<em>type</em> is not compatible with the type of the actual next argument (as promoted according
to the default argument promotions), the behavior is undefined, except for the following
cases:</p>
<ul class="simple">
<li>one type is a signed integer type, the other type is the corresponding unsigned integer
type, and the value is representable in both types;</li>
<li>one type is pointer to void and the other is a pointer to a character type.</li>
</ul>
<p><strong>Returns</strong></p>
<p>The first invocation of the <tt class="docutils literal"><span class="pre">va_arg</span></tt> macro after that of the <tt class="docutils literal"><span class="pre">va_start</span></tt> macro returns the
value of the argument after that specified by <tt class="docutils literal"><span class="pre">parmN</span></tt>. Successive inv ocations return the
values of the remaining arguments in succession.</p>
</div>
<div class="section" id="the-va-copy-macro">
<span id="index-3"></span><h3>27.1.2. The <tt class="docutils literal"><span class="pre">va_copy</span></tt> macro<a class="headerlink" href="#the-va-copy-macro" title="Permalink to this headline">¶</a></h3>
<p><strong>Synopsis</strong></p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdarg.h&gt;</span>
<span class="kt">void</span> <span class="nf">va_copy</span><span class="p">(</span><span class="kt">va_list</span> <span class="n">dest</span><span class="p">,</span> <span class="kt">va_list</span> <span class="n">src</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Description</strong></p>
<p>The <tt class="docutils literal"><span class="pre">va_copy</span></tt> macro initializes dest as a copy of <tt class="docutils literal"><span class="pre">src</span></tt>, as if the <tt class="docutils literal"><span class="pre">va_start</span></tt> macro had
been applied to dest followed by the same sequence of uses of the <tt class="docutils literal"><span class="pre">va_arg</span></tt> macro as
had previously been used to reach the present state of <tt class="docutils literal"><span class="pre">src</span></tt>. Neither the <tt class="docutils literal"><span class="pre">va_copy</span></tt> nor
<tt class="docutils literal"><span class="pre">va_start</span></tt> macro shall be invoked to reinitialize dest without an intervening
invocation of the <tt class="docutils literal"><span class="pre">va_end</span></tt> macro for the same dest.</p>
<p><strong>Returns</strong></p>
<p>The <tt class="docutils literal"><span class="pre">va_copy</span></tt> macro returns no value.</p>
</div>
<div class="section" id="the-va-end-macro">
<span id="index-4"></span><h3>27.1.3. The <tt class="docutils literal"><span class="pre">va_end</span></tt> macro<a class="headerlink" href="#the-va-end-macro" title="Permalink to this headline">¶</a></h3>
<p><strong>Synopsis</strong></p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdarg.h&gt;</span>
<span class="kt">void</span> <span class="nf">va_end</span><span class="p">(</span><span class="kt">va_list</span> <span class="n">ap</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Description</strong></p>
<p>The <tt class="docutils literal"><span class="pre">va_end</span></tt> macro facilitates a normal return from the function whose variable
argument list was referred to by the expansion of the <tt class="docutils literal"><span class="pre">va_start</span></tt> macro, or the function
containing the expansion of the <tt class="docutils literal"><span class="pre">va_copy</span></tt> macro, that initialized the <tt class="docutils literal"><span class="pre">va_list</span> <span class="pre">ap</span></tt>. The
<tt class="docutils literal"><span class="pre">va_end</span></tt> macro may modify <tt class="docutils literal"><span class="pre">ap</span></tt> so that it is no longer usable (without being reinitialized
by the <tt class="docutils literal"><span class="pre">va_start</span></tt> or <tt class="docutils literal"><span class="pre">va_copy</span></tt> macro). If there is no corresponding invocation of the
<tt class="docutils literal"><span class="pre">va_start</span></tt> or <tt class="docutils literal"><span class="pre">va_copy</span></tt> macro or if the <tt class="docutils literal"><span class="pre">va_end</span></tt> macro is not invoked before the
return, the behavior is undefined.</p>
<p><strong>Returns</strong></p>
<p>The <tt class="docutils literal"><span class="pre">va_end</span></tt> macro returns no value.</p>
</div>
<div class="section" id="the-va-start-macro">
<span id="index-5"></span><h3>27.1.4. The <tt class="docutils literal"><span class="pre">va_start</span></tt> macro<a class="headerlink" href="#the-va-start-macro" title="Permalink to this headline">¶</a></h3>
<p><strong>Synopsis</strong></p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdarg.h&gt;</span>
<span class="kt">void</span> <span class="nf">va_start</span><span class="p">(</span><span class="kt">va_list</span> <span class="n">ap</span><span class="p">,</span> <span class="n">parmN</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>Description</strong></p>
<p>The <tt class="docutils literal"><span class="pre">va_start</span></tt> macro shall be invoked before any access to the unnamed arguments.</p>
<p>The <tt class="docutils literal"><span class="pre">va_start</span></tt> macro initializes ap for subsequent use by the <tt class="docutils literal"><span class="pre">va_arg</span></tt> and <tt class="docutils literal"><span class="pre">va_end</span></tt>
macros. Neither the <tt class="docutils literal"><span class="pre">va_start</span></tt> nor <tt class="docutils literal"><span class="pre">va_copy</span></tt> macro shall be invoked to reinitialize <tt class="docutils literal"><span class="pre">ap</span></tt>
without an intervening invocation of the <tt class="docutils literal"><span class="pre">va_end</span></tt> macro for the same <tt class="docutils literal"><span class="pre">ap</span></tt>.</p>
<p>The parameter <tt class="docutils literal"><span class="pre">parmN</span></tt> is the identifier of the rightmost parameter in the variable
parameter list in the function definition (the one just before the , <tt class="docutils literal"><span class="pre">...</span></tt>). If the parameter
parmN is declared with the <tt class="docutils literal"><span class="pre">register</span></tt> storage class, with a function or array type, or
with a type that is not compatible with the type that results after application of the default
argument promotions, the behavior is undefined.</p>
<p><strong>Returns</strong></p>
<p>The <tt class="docutils literal"><span class="pre">va_start</span></tt> macro returns no value.</p>
<p>EXAMPLE 1 The function <tt class="docutils literal"><span class="pre">f1</span></tt> gathers into an array a list of arguments that are pointers to strings (but not
more than <tt class="docutils literal"><span class="pre">MAXARGS</span></tt> arguments), then passes the array as a single argument to function <tt class="docutils literal"><span class="pre">f2</span></tt>. The number of
pointers is specified by the first argument to <tt class="docutils literal"><span class="pre">f1</span></tt>.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdarg.h&gt;</span>

<span class="cp">#define MAXARGS 31</span>

<span class="kt">void</span> <span class="nf">f1</span><span class="p">(</span><span class="kt">int</span> <span class="n">n_ptrs</span><span class="p">,</span> <span class="p">...)</span>
<span class="p">{</span>
  <span class="kt">va_list</span> <span class="n">ap</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">array</span><span class="p">[</span><span class="n">MAXARGS</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">ptr_no</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">n_ptrs</span> <span class="o">&gt;</span> <span class="n">MAXARGS</span><span class="p">)</span>
      <span class="n">n_ptrs</span> <span class="o">=</span> <span class="n">MAXARGS</span><span class="p">;</span>

    <span class="n">va_start</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">n_ptrs</span><span class="p">);</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">ptr_no</span> <span class="o">&lt;</span> <span class="n">n_ptrs</span><span class="p">)</span>
      <span class="n">array</span><span class="p">[</span><span class="n">ptr_no</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">va_arg</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="p">);</span>

    <span class="n">va_end</span><span class="p">(</span><span class="n">ap</span><span class="p">);</span>
    <span class="n">f2</span><span class="p">(</span><span class="n">n_ptrs</span><span class="p">,</span> <span class="n">array</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each call to <tt class="docutils literal"><span class="pre">f1</span></tt> is required to have visible the definition of the function or a declaration such as</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">f1</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="p">...);</span>
</pre></div>
</div>
<p>EXAMPLE 2 The function <tt class="docutils literal"><span class="pre">f3</span></tt> is similar, but saves the status of the variable argument list after the
indicated number of arguments; after <tt class="docutils literal"><span class="pre">f2</span></tt> has been called once with the whole list, the trailing part of the list
is gathered again and passed to function <tt class="docutils literal"><span class="pre">f4</span></tt>.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdarg.h&gt;</span>

<span class="cp">#define MAXARGS 31</span>

<span class="kt">void</span> <span class="nf">f3</span><span class="p">(</span><span class="kt">int</span> <span class="n">n_ptrs</span><span class="p">,</span> <span class="kt">int</span> <span class="n">f4_after</span><span class="p">,</span> <span class="p">...)</span>
<span class="p">{</span>
  <span class="kt">va_list</span> <span class="n">ap</span><span class="p">,</span> <span class="n">ap_save</span><span class="p">;</span>
  <span class="kt">char</span> <span class="o">*</span><span class="n">array</span><span class="p">[</span><span class="n">MAXARGS</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">ptr_no</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">n_ptrs</span> <span class="o">&gt;</span> <span class="n">MAXARGS</span><span class="p">)</span>
    <span class="n">n_ptrs</span> <span class="o">=</span> <span class="n">MAXARGS</span><span class="p">;</span>

  <span class="n">va_start</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="n">f4_after</span><span class="p">);</span>

  <span class="k">while</span> <span class="p">(</span><span class="n">ptr_no</span> <span class="o">&lt;</span> <span class="n">n_ptrs</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">array</span><span class="p">[</span><span class="n">ptr_no</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">va_arg</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ptr_no</span> <span class="o">==</span> <span class="n">f4_after</span><span class="p">)</span>
      <span class="n">va_copy</span><span class="p">(</span><span class="n">ap_save</span><span class="p">,</span> <span class="n">ap</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">va_end</span><span class="p">(</span><span class="n">ap</span><span class="p">);</span>
  <span class="n">f2</span><span class="p">(</span><span class="n">n_ptrs</span><span class="p">,</span> <span class="n">array</span><span class="p">);</span>
  <span class="c1">// Now process the saved copy.</span>
  <span class="n">n_ptrs</span> <span class="o">-=</span> <span class="n">f4_after</span><span class="p">;</span>
  <span class="n">ptr_no</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">ptr_no</span> <span class="o">&lt;</span> <span class="n">n_ptrs</span><span class="p">)</span>
    <span class="n">array</span><span class="p">[</span><span class="n">ptr_no</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">va_arg</span><span class="p">(</span><span class="n">ap_save</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="p">);</span>
  <span class="n">va_end</span><span class="p">(</span><span class="n">ap_save</span><span class="p">);</span>
  <span class="n">f4</span><span class="p">(</span><span class="n">n_ptrs</span><span class="p">,</span> <span class="n">array</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2012, Shiv S. Dayal.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>